<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AntLiteCSS/custom css util Landing Page for E-learning</title>
    <link href="./css/index.css" rel="stylesheet" />
    <link href="./css/auth.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

    <style>
        html,
        body {
            margin: 0;
            padding: 0;
        }

        #wrap {
            display: grid;
            grid-gap: 0px;
            grid-template-columns: 10vw 70vw;
            grid-template-areas: "left right";
            height: 100vh;

        }

        #left {
            grid-area: left;
            position: absolute;
            margin-top: 140px;
            min-height: 100%;
        }

        #right {
            margin-top: 80px;
            grid-area: right;
            background: #eafaea;

            position: absolute;
            right: 0;
            min-height: 100%;
        }

        #handle {
            width: 8px;
            height: 70px;
            background: #B3B3B3;
            border-radius: 4px;
            vertical-align: top;
            position: absolute;
            display: inline-block;
            user-select: none;
        }

        #handle:after {
            content: '';
            float: left;
            width: 2px;
            height: 8px;
            background: #000;
            pointer-events: none;
            margin-top: -40px;
            margin-left: 3px;
            border-radius: 4px;
            transition: all .4s ease 0s;
        }

        #handle:before {
            content: '';
            float: left;
            width: 8px;
            height: 70px;
            background: #777;
            pointer-events: none;
            margin-top: 0px;
            margin-left: 0px;
            box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.32);
            border-radius: 4px;
            transition: all .4s ease 0s;
        }

        #handle:hover {
            background: #888;
            cursor: col-resize;
        }

        #handle:hover:after {
            background: #276EF1;
        }

        #handle:active:after {
            background: #276EF1;
        }

        *,
        *:before,
        *:after {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
    </style>

</head>

<body class="bg-light text-md font-base text-primary">
    <header class="bg-white border-b shadow-sm p-3 fixed z-10">




        <div class="flex justify-between ">
            <div class="text-center ">
                <h1 class="text-lg font-bold">UNI<span class="text-warning">CAST</span></h1>
                <p class="text-muted text-sm">E-LEARNING COMPANY</p>
            </div>
            <!-- Trigger Button on Small Screens -->
            <button class=" left-4 z-50  bg-blue-600 text-black rounded" onclick="toggleDrawer(true)">
                ðŸ“š Browse Lessons
            </button>
        </div>
    </header>



    <div id="wrap">

        <div id="left" class="relative">
            <input style="width:388px; padding:12px; margin:10px" type="text" placeholder="Search lessons..."
                class="p-3 py-2 mb-4 rounded bg-white text-white placeholder-gray-400 focus:outline-none mr-9"
                oninput="handleSearch(this.value)" />
            <aside class="hidden sm:block w-[230px]  text-white p-4 overflow-y-auto">
                <h2 class="text-lg font-semibold mb-4">Course Modules</h2>
                <div id="accordionMenu" class="space-y-2"></div>
            </aside>
            <!-- Mobile Drawer -->
            <!-- <div id="mobileDrawer" class=" inset-0   bg-opacity-50 backdrop-blur-sm ">
                <div
                    class="">
                    <div class="flex justify-between items-center mb-2">
                        <h2 class="text-lg font-semibold">Course Modules</h2>
                        <button onclick="toggleDrawer(false)">âœ–</button>
                    </div>
                    <div id="moduleMenu" class="text-sm text-gray-800 space-y-4 p-2 m-1"></div>
                </div>
            </div> -->

        </div>
        <div id="right">

            <main class="flex-1 bg-white p-6 overflow-y-auto">

                <div id="courseContent">Select a lesson from the left panel.</div>
            </main>
            <div id="handle"></div>
        </div>
    </div>

  <script src="./js/init.js"></script>
    <script>
        const left = document.getElementById('left');
        const right = document.getElementById('right');
        const handle = document.getElementById('handle');
        const wrap = document.getElementById('wrap');
        const winWidth = window.innerWidth;
        const winHeight = window.innerHeight;

        document.addEventListener("DOMContentLoaded", () => {
            const leftWidth = winWidth * 0.3;
            const rightWidth = winWidth * 0.7;

            left.style.width = leftWidth + 'px';
            right.style.width = rightWidth + 'px';
            handle.style.top = (winHeight / 2 - 35) + 'px';
            handle.style.right = (rightWidth - 4) + 'px';

            rStartWidth = rightWidth;
            lStartWidth = leftWidth;

            handle.addEventListener('mousedown', setup, false);
        });

        let StartX, rStartWidth, lStartWidth;

        function setup(event) {
            StartX = event.clientX;
            rStartWidth = parseInt(window.getComputedStyle(right).width, 10);
            lStartWidth = parseInt(window.getComputedStyle(left).width, 10);

            document.documentElement.addEventListener('mousemove', drag, false);
            document.documentElement.addEventListener('mouseup', destroy, false);
        }

        function drag(event) {
            const newLeft = lStartWidth + event.clientX - StartX;
            const newRight = rStartWidth - event.clientX + StartX;

            left.style.width = newLeft + 'px';
            right.style.width = newRight + 'px';
            handle.style.right = (newRight - 4) + 'px';
        }

        function destroy() {
            document.documentElement.removeEventListener('mousemove', drag, false);
            document.documentElement.removeEventListener('mouseup', destroy, false);
        }



        //DEMO MODULES
        const drawer = document.getElementById('mobileDrawer');
        const menu = document.getElementById('moduleMenu');

        function toggleDrawer(open) {
            drawer.classList.toggle('hidden', !open);
        }

       

// the html slides for the course 

      const readableSlides = 
                                `<h3>HTML stands for HyperText Markup Language</h3>

                                <p>freestar
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam ultrices ac orci sed mollis. Duis pellentesque lacus id erat euismod, in porttitor massa blandit. In non sapien eget nunc interdum luctus nec et tortor. Pellentesque id nibh eget ligula volutpat hendrerit ac quis mauris.
 Mauris tellus arcu, ultricies mollis arcu eu, pretium facilisis mauris. Proin tortor lectus, tincidunt at arcu eget, dapibus luctus nibh. Sed fringilla, ex quis interdum dapibus, est purus commodo massa, quis commodo neque metus quis nisi. Maecenas a urna ut ipsum pulvinar interdum. Suspendisse dui turpis, euismod id sodales elementum, laoreet vitae metus. Sed sodales facilisis leo. Cras nec interdum lorem, eget iaculis magna. Ut facilisis, turpis a rhoncus bibendum, libero eros pulvinar eros, non euismod tortor sem vel felis. Curabitur eu cursus tellus, id hendrerit nulla. Phasellus venenatis enim a eleifend lobortis. Mauris consectetur, turpis hendrerit sollicitudin bibendum, turpis sapien laoreet sem, sit amet maximus orci nibh sit amet neque.
</p>

<p>Nulla fermentum lorem eu finibus imperdiet. Nullam malesuada sit amet sapien non elementum. In hac habitasse platea dictumst. Curabitur semper nibh id erat ultricies, eu molestie nulla varius. Sed porttitor metus ac ante ultrices, sed pretium tortor tincidunt. Cras pulvinar suscipit fringilla. Praesent lectus est, consectetur sed gravida non, convallis ut ligula. Vivamus sed facilisis risus. Interdum et malesuada fames ac ante ipsum primis in faucibus. Mauris dapibus, quam convallis elementum egestas, ligula felis congue neque, non rhoncus tortor velit sed diam. Curabitur rutrum faucibus nulla quis sagittis. Donec quis fermentum sem, non pellentesque lorem. Vestibulum blandit nisi lobortis mauris bibendum luctus. Vestibulum justo justo, sodales nec orci sit amet, aliquet sagittis odio. Pellentesque rutrum, ex nec dapibus ornare, ex enim molestie nisl, ac placerat ex dolor eu magna.
</p>

<p>Praesent scelerisque lobortis diam a sagittis. Aenean porttitor dolor non magna luctus laoreet. Mauris nec ante efficitur, laoreet magna et, tempor urna. Ut feugiat iaculis dolor, at faucibus eros blandit non. Nulla vel diam fringilla, ultricies tortor eu, congue leo. Sed est arcu, tristique et felis sed, porttitor cursus nisi. Cras fringilla ut nunc in ultrices. Proin elementum porttitor enim in aliquet. Mauris nec sapien aliquet, pulvinar ligula sed, eleifend dolor. Nunc sagittis risus et orci scelerisque, id facilisis neque aliquam. Maecenas id leo odio. Quisque felis ex, tincidunt sit amet enim congue, laoreet ultricies elit. Maecenas et libero nec eros vulputate faucibus.
</p>

<p>Sed cursus venenatis urna maximus dapibus. Maecenas felis magna, porttitor sit amet velit in, semper interdum sem. Etiam varius, lacus et tempor sodales, mi lacus finibus leo, vitae vehicula nisi lectus in eros. Aenean accumsan arcu id placerat maximus. Quisque vitae ornare purus, at malesuada risus. Quisque et interdum lectus. Cras vel tincidunt velit, ac aliquam tellus. Nam metus nisi, feugiat eget commodo eget, semper a nisi. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam feugiat magna in ornare dignissim. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.
</p>

<p>Nunc placerat, magna sit amet rhoncus luctus, nisi nibh bibendum turpis, et ullamcorper elit lectus eu libero. Integer feugiat ex eget congue aliquam. Cras lectus lorem, laoreet quis felis sit amet, ultricies tempor dui. Etiam imperdiet tempus tortor ac consequat. In hac habitasse platea dictumst. Nulla facilisi. Cras nec eros est.
   </p>                             
                                `
      const readableSlides2 =   `
                                
                                <p>freestar
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam ultrices ac orci sed mollis. Duis pellentesque lacus id erat euismod, in porttitor massa blandit. In non sapien eget nunc interdum luctus nec et tortor. Pellentesque id nibh eget ligula volutpat hendrerit ac quis mauris.
 Mauris tellus arcu, ultricies mollis arcu eu, pretium facilisis mauris. Proin tortor lectus, tincidunt at arcu eget, dapibus luctus nibh. Sed fringilla, ex quis interdum dapibus, est purus commodo massa, quis commodo neque metus quis nisi. Maecenas a urna ut ipsum pulvinar interdum. Suspendisse dui turpis, euismod id sodales elementum, laoreet vitae metus. Sed sodales facilisis leo. Cras nec interdum lorem, eget iaculis magna. Ut facilisis, turpis a rhoncus bibendum, libero eros pulvinar eros, non euismod tortor sem vel felis. Curabitur eu cursus tellus, id hendrerit nulla. Phasellus venenatis enim a eleifend lobortis. Mauris consectetur, turpis hendrerit sollicitudin bibendum, turpis sapien laoreet sem, sit amet maximus orci nibh sit amet neque.
</p>

<p>Nulla fermentum lorem eu finibus imperdiet. Nullam malesuada sit amet sapien non elementum. In hac habitasse platea dictumst. Curabitur semper nibh id erat ultricies, eu molestie nulla varius. Sed porttitor metus ac ante ultrices, sed pretium tortor tincidunt. Cras pulvinar suscipit fringilla. Praesent lectus est, consectetur sed gravida non, convallis ut ligula. Vivamus sed facilisis risus. Interdum et malesuada fames ac ante ipsum primis in faucibus. Mauris dapibus, quam convallis elementum egestas, ligula felis congue neque, non rhoncus tortor velit sed diam. Curabitur rutrum faucibus nulla quis sagittis. Donec quis fermentum sem, non pellentesque lorem. Vestibulum blandit nisi lobortis mauris bibendum luctus. Vestibulum justo justo, sodales nec orci sit amet, aliquet sagittis odio. Pellentesque rutrum, ex nec dapibus ornare, ex enim molestie nisl, ac placerat ex dolor eu magna.
</p>

<p>Praesent scelerisque lobortis diam a sagittis. Aenean porttitor dolor non magna luctus laoreet. Mauris nec ante efficitur, laoreet magna et, tempor urna. Ut feugiat iaculis dolor, at faucibus eros blandit non. Nulla vel diam fringilla, ultricies tortor eu, congue leo. Sed est arcu, tristique et felis sed, porttitor cursus nisi. Cras fringilla ut nunc in ultrices. Proin elementum porttitor enim in aliquet. Mauris nec sapien aliquet, pulvinar ligula sed, eleifend dolor. Nunc sagittis risus et orci scelerisque, id facilisis neque aliquam. Maecenas id leo odio. Quisque felis ex, tincidunt sit amet enim congue, laoreet ultricies elit. Maecenas et libero nec eros vulputate faucibus.
</p>

<p>Sed cursus venenatis urna maximus dapibus. Maecenas felis magna, porttitor sit amet velit in, semper interdum sem. Etiam varius, lacus et tempor sodales, mi lacus finibus leo, vitae vehicula nisi lectus in eros. Aenean accumsan arcu id placerat maximus. Quisque vitae ornare purus, at malesuada risus. Quisque et interdum lectus. Cras vel tincidunt velit, ac aliquam tellus. Nam metus nisi, feugiat eget commodo eget, semper a nisi. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam feugiat magna in ornare dignissim. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.
</p>

<p>Nunc placerat, magna sit amet rhoncus luctus, nisi nibh bibendum turpis, et ullamcorper elit lectus eu libero. Integer feugiat ex eget congue aliquam. Cras lectus lorem, laoreet quis felis sit amet, ultricies tempor dui. Etiam imperdiet tempus tortor ac consequat. In hac habitasse platea dictumst. Nulla facilisi. Cras nec eros est.
   </p>    
                                `


        const freeCourse = pickRandomSubset(getMockDatabaseCourses(), 2)[0]
        let courses = localStorage.getItem("study_course_lms") ?  JSON.parse( localStorage.getItem("study_course_lms")) :  freeCourse

        courses = course.curriculum.map((section, i) => { return {
            ...section,
            htmlSlides: [readableSlides,readableSlides2]
        }})
        const accordionMenu = document.getElementById("accordionMenu");
        const contentArea = document.getElementById("courseContent");

        function renderAccordion(course) {
            accordionMenu.innerHTML = course.curriculum.map((section, i) => {
                const sectionId = `section-${i}`;
                return `
      <div class="border rounded">
        <button class="w-full text-left px-3 py-2 font-semibold bg-gray-800 p-6 mb-5"
          onclick="toggleAccordion('${sectionId}')" style="height:40px; padding:10px;">
          ${section.title}
        </button>
        <div id="${sectionId}" class="pl-4 hidden bg-white text-sm p-3">
          ${section.children.map((sub, j) => `
            <div class="py-1 pl-3  cursor-pointer"
                 onclick="loadLesson('${section.title}', '${sub.title}'); loadModuleLesson(${i},${j})">
              ðŸ“„ ${sub.title}
            </div>
          `).join("")}
        </div>
      </div>
    `;
            }).join("");
        }

        function toggleAccordion(id) {
            const section = document.getElementById(id);
            section.classList.toggle("hidden");
        }

        function loadLesson(section, sub) {
            contentArea.innerHTML = `
    <h2 class="text-xl font-semibold mb-2">${sub}</h2>
    <p>You are now viewing: <strong>${section} â†’ ${sub}</strong>.</p>
  `;
        }

        renderAccordion(courses);

        // search mockup
        const originalCurriculum = [...courses.curriculum]; // Keep a copy of the full curriculum

        function handleSearch(query) {
            const filtered = courses.curriculum.map(section => {
                // Match section or any subsection
                const matchedchildren = section.children.filter(sub =>
                    sub.title.toLowerCase().includes(query.toLowerCase())
                );

                if (
                    section.title.toLowerCase().includes(query.toLowerCase()) ||
                    matchedchildren.length > 0
                ) {
                    return {
                        title: section.title,
                        children: matchedchildren.length > 0 ? matchedchildren : section.children
                    };
                }

                return null;
            }).filter(Boolean);

            renderAccordion({ curriculum: filtered });
        }



        // load course
        function loadModuleLesson(sectionIndex, subIndex) {
            const sub = courses.curriculum[sectionIndex].children[subIndex];
            const key = `progress-${courses.title}-${sub.title}`;
            const isComplete = localStorage.getItem(key) === "complete";

            if (sub.locked && !isComplete) {
                courseContent.innerHTML = `<div class="text-red-500 font-bold">ðŸ”’ This lesson is locked.</div>`;
                return;
            }

            let html = `
    <h2 class="text-xl font-semibold mb-2">${sub.title}</h2>
    ${sub.video ? `
      <div class="mb-4">
        <iframe class="w-full h-64" src="${sub.video}" frameborder="0" allowfullscreen style="height: 400px"></iframe>
      </div>
    ` : ''}

    ${sub.htmlSlides?.length ? renderSlideShow(sub, key) : ''}
  `;

            courseContent.innerHTML = html;
        }


        function renderSlideShow(sub, progressKey) {
            const id = `slide-${progressKey.replace(/[^a-zA-Z0-9]/g, '')}`; // ID-safe
            const variableName = `slides_${id}`;
            const slides = sub.htmlSlides || [];

            // Store progress (simulate after short delay)
            setTimeout(() => {
                localStorage.setItem(progressKey, "complete");
                checkUnlockQuiz();
            }, 1000);

            // Register slide content in global scope
            window[variableName] = slides;

            return `
    <div id="${id}" data-index="0">
      <div class="html-slide">${slides[0]}</div>
      <div class="flex gap-2 mt-4">
        <button onclick="prevSlide('${id}', '${slides}')" class="px-3 py-1 border">â¬… Prev</button>
        <button onclick="nextSlide('${id}', '${slides}')" class="px-3 py-1 border">Next âž¡</button>
      </div>
    </div>
  `;
        }


        function nextSlide(id, varName) {
            const container = document.getElementById(id);
            let index = parseInt(container.dataset.index || '0');
            const slides = window[varName];

            if (index < slides.length - 1) {
                index++;
                container.dataset.index = index;
                container.querySelector(".html-slide").innerHTML = slides[index];
                markSlideRead(course.title, currentSubTitle, index); // Optional tracking
            }
        }

        function prevSlide(id, varName) {
            const container = document.getElementById(id);
            let index = parseInt(container.dataset.index || '0');
            const slides = window[varName];

            if (index > 0) {
                index--;
                container.dataset.index = index;
                container.querySelector(".html-slide").innerHTML = slides[index];
                markSlideRead(course.title, currentSubTitle, index); // Optional tracking
            }
        }



        function checkUnlockQuiz() {
            const allSubmodules = courses.curriculum.flatMap(section =>
                section.children || []
            );

            const allComplete = allSubmodules.every(sub => {
                const key = `progress-${courses.title}-${sub.title}`;
                return localStorage.getItem(key) === "complete";
            });

            if (allComplete) {
                // Unlock quiz module
                const quiz = courses.curriculum.find(sec => sec.isQuiz);
                if (quiz) {
                    quiz.locked = false;
                    console.log("Quiz unlocked!");
                }
            }
        }


        //tracker sample for analytics and resume where user stoped

        /*{
  "progress-Frontend Bootcamp": {
    lastViewed: {
      sectionIndex: 0,
      subIndex: 1
    },
    modules: {
      "1.1 What is HTML?": {
        videoWatched: true,
        slidesRead: [0, 1], // indexes of read slides
        completed: true
      },
      "1.2 Tags and Elements": {
        videoWatched: false,
        slidesRead: [0],
        completed: false
      }
    }
  }
}
*/

        function setLastViewed(courseTitle, sectionIndex, subIndex) {
            const key = `progress-${courseTitle}`;
            const data = JSON.parse(localStorage.getItem(key)) || {};
            data.lastViewed = { sectionIndex, subIndex };
            localStorage.setItem(key, JSON.stringify(data));
        }

        function getLastViewed(courseTitle) {
            const data = JSON.parse(localStorage.getItem(`progress-${courseTitle}`));
            return data?.lastViewed;
        }


        function markVideoWatched(courseTitle, subTitle) {
            const key = `progress-${courseTitle}`;
            const data = JSON.parse(localStorage.getItem(key)) || { modules: {} };
            if (!data.modules) data.modules = {};
            if (!data.modules[subTitle]) data.modules[subTitle] = {};
            data.modules[subTitle].videoWatched = true;
            checkIfSubmoduleCompleted(data, subTitle);
            localStorage.setItem(key, JSON.stringify(data));
        }

        function markSlideRead(courseTitle, subTitle, slideIndex) {
            const key = `progress-${courseTitle}`;
            const data = JSON.parse(localStorage.getItem(key)) || { modules: {} };
            if (!data.modules) data.modules = {};
            if (!data.modules[subTitle]) data.modules[subTitle] = { slidesRead: [] };
            data.modules[subTitle].slidesRead = Array.from(new Set([
                ...(data.modules[subTitle].slidesRead || []),
                slideIndex
            ]));
            checkIfSubmoduleCompleted(data, subTitle);
            localStorage.setItem(key, JSON.stringify(data));
        }

        function checkIfSubmoduleCompleted(data, subTitle) {
            const sub = data.modules[subTitle];
            if (sub.videoWatched && sub.slidesRead?.length >= getSlideCount(subTitle)) {
                sub.completed = true;
            }
        }

        //onload
        function resumeLastLesson(courseTitle) {
            const last = getLastViewed(courseTitle);
            if (last) {
                loadLesson(last.sectionIndex, last.subIndex);
            } else {
                loadLesson(0, 0); // Start fresh
            }
        }


        document.addEventListener("DOMContentLoaded", () => {
            resumeLastLesson("Frontend Bootcamp")
        })
    </script>